Theory
######

(Updating)

SMARTS Matching and Reactions
******************************

SMARTS (SMiles ARbitrary Target Specification) is a powerful and flexible language designed to describe molecular patterns and chemical transformations. It plays a critical role in cheminformatics by enabling precise substructure searches and reaction modeling.[1]_

SMARTS Matching
===============

SMARTS matching is the process of identifying substructures in a molecule that fit a specific pattern. These patterns can represent atoms, bonds, or entire molecular frameworks, making SMARTS ideal for:

- Identifying functional groups.
- Highlighting specific bonding arrangements.
- Locating potential reaction sites.

SMARTS Reactions
================

SMARTS reactions build on the concept of matching by defining transformations:

- **Reactant Definition**: Specifies the pattern to locate the target structure.
- **Product Definition**: Details how the target structure changes after the reaction.
- **Atom Mapping**: Ensures that atoms in the reactant and product are consistently related.

SMARTS reactions allow for automated modifications of molecular structures, including protonation, tautomer enumeration, and functional group replacements.


SMARTS Matching and Reactions in MolSanitizer
================

MolSanitizer leverages the power of SMARTS matching and reactions to automate the preparation and filtering of molecular datasets for drug discovery. Below are the key applications:

1. **Tautomer Standardization**:

   - MolSanitizer employs a two-step approach to tautomer standardization, combining RDKit's tautomer canonicalization functionality with SMARTS reactions for enhanced refinement. Initially, RDKit's canonicalization function generates the base set of tautomers. These are then further refined using SMARTS reactions to ensure the selection of the most chemically stable and biologically relevant tautomer.

2. **PAINS and Unwanted Substructure Filtering**:

   - SMARTS enables the identification of undesirable substructures like PAINS (Pan Assay Interference Compounds)[2]_ and reactive functional groups. Custom SMARTS patterns allow users to extend or modify filtering rules to suit specific project requirements.

3. **Protonation**:

   - Protonation states are assigned iteratively using SMARTS-based rules for ionizable groups. This ensures molecules are prepared for pH-specific environments, with expanded outputs for cases of multiple possible states.


4. **Matching Rigid Scaffolds and Invertable Chiral Centers**:

   - MolSanitizer uses SMARTS to detect substructures such as rings and aromatic nitrogen to correct geometry due to systematic errors of MMFF94s. SMARTS matching is also the foundation for dihedral matching of the molecules to the Torsional Library[3]_,[4]_,[5]_, which drives conformational sampling for docking.

For more detailed usage and examples, refer to the :doc:`usage` section.

---

Conformational Sampling
***********************

Unlike the traditional conformational sampling algorithm of UCSF DOCK, which performs systematic torsional scans based on JChem, CORINA, and OMEGA, MolSanitizer uses RDKit to generate conformers. The conformers are generated by sampling the torsional angles of the rotatable bonds. The number of conformers is controlled by the user.

---

References
==========

.. [1] Daylight Chemical Information Systems, Inc., "SMARTS - A Language for Describing Molecular Patterns",
   Available at: https://www.daylight.com/dayhtml/doc/theory/theory.smarts.html
.. [2] Baell, Jonathan B., and Georgina A. Holloway. "New substructure filters for removal of pan assay interference compounds (PAINS) from screening libraries and for their exclusion in bioassays." Journal of medicinal chemistry 53.7 (2010): 2719-2740.
.. [3] Scharfer, C., Schulz-Gasch, T., Ehrlich, H. C., Guba, W., Rarey, M., & Stahl, M. (2013). Torsion angle preferences in druglike chemical space: a comprehensive guide. Journal of Medicinal Chemistry, 56(5), 2016-2028.
.. [4] Guba, W., Meyder, A., Rarey, M., & Hert, J. (2016). Torsion library reloaded: a new version of expert-derived SMARTS rules for assessing conformations of small molecules. Journal of chemical information and modeling, 56(1), 1-5.
.. [5] Penner, P., Guba, W., Schmidt, R., Meyder, A., Stahl, M., & Rarey, M. (2022). The torsion library: Semiautomated improvement of torsion rules with SMARTScompare. Journal of Chemical Information and Modeling, 62(7), 1644-1653.